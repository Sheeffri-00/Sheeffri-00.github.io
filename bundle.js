(()=>{"use strict";var t={28:(t,e,n)=>{n.d(e,{Z:()=>a});var i=n(81),r=n.n(i),o=n(645),s=n.n(o)()(r());s.push([t.id,"html {\n    height: 100%;\n    overflow: hidden;\n}\n\nbody {\n    margin: 0;\n    background-color: #d0d0e0;\n    height: 100%;\n    overflow: hidden;\n}\n\n.content {\n    display: flex;    \n    flex-direction: column;\n    justify-content: stretch;\n    align-items: center;\n}\n\n#canvasContainer {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    padding: 70px 12px;\n    width: 100%;\n    max-width: 450px;    \n    box-sizing: border-box;    \n}\n\n.buttons {\n    display: flex;\n    width: calc(20px + 30%);\n}\n\n.restart {\n    font-size: 20px;\n    width: 100%;\n    border: 0;\n    background-color: #d0d022;\n    color: #ffffff;\n    height: 36px;\n    border-radius: 18px;\n    cursor: pointer;\n    font-weight: bold;\n    letter-spacing: 0.8px;\n    outline: none;\n}",""]);const a=s},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<t.length;c++){var h=[].concat(t[c]);i&&s[h[0]]||(void 0!==o&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=o),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),r&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=r):h[4]="".concat(r)),e.push(h))}},e}},81:t=>{t.exports=function(t){return t[1]}},379:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},s=[],a=0;a<t.length;a++){var l=t[a],c=i.base?l[0]+i.base:l[0],h=o[c]||0,u="".concat(c," ").concat(h);o[c]=h+1;var p=n(u),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(d);else{var f=r(d,i);i.byIndex=a,e.splice(a,0,{identifier:u,updater:f,references:1})}s.push(u)}return s}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=i(t=t||[],r=r||{});return function(t){t=t||[];for(var s=0;s<o.length;s++){var a=n(o[s]);e[a].references--}for(var l=i(t,r),c=0;c<o.length;c++){var h=n(o[c]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}o=l}}},569:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,exports:{}};return t[i](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0;var i={};(()=>{n.d(i,{J:()=>R,C:()=>L});var t,e=n(379),r=n.n(e),o=n(795),s=n.n(o),a=n(569),l=n.n(a),c=n(565),h=n.n(c),u=n(216),p=n.n(u),d=n(589),f=n.n(d),v=n(28),m={};m.styleTagTransform=f(),m.setAttributes=h(),m.insert=l().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=p(),r()(v.Z,m),v.Z&&v.Z.locals&&v.Z.locals,function(t){t[t.Up=0]="Up",t[t.Down=1]="Down",t[t.Left=2]="Left",t[t.Right=3]="Right"}(t||(t={}));var y=function(){function t(t,e){this._tile=t,this.props=e,this.currX=e.startX,this.currY=e.startY,this.props.endX,this.currX,this.props.endY,this.currY,this.velX=(this.props.endX-this.props.startX)/5,this.velY=(this.props.endY-this.props.startY)/5}return t.prototype.act=function(){this.currX+=this.velX,this.currY+=this.velY;var t=Math.abs(this.props.endX-this.currX),e=Math.abs(this.props.endY-this.currY);t<=.1&&e<=.1&&(this.currX=this.props.endX,this.currY=this.props.endY,this.props.onFinish())},t}(),b=function(){function t(t,e){this._tile=t,this.props=e,this.currX=this.props.startX,this.currY=this.props.startY,this.props.endX,this.currX,this.props.endY,this.currY,this.velX=(this.props.endX-this.props.startX)/this.props.duration/5,this.velY=(this.props.endY-this.props.startY)/this.props.duration/5}return t.prototype.act=function(){this.currX+=this.velX,this.currY+=this.velY;var t=this.props.startX<=this.props.endX?1:-1,e=this.props.startY<=this.props.endY?1:-1,n=!1;t*(this.props.endX-this.currX)<=0&&e*(this.props.endY-this.currY)<=0&&(this.currX=this.props.endX,this.currY=this.props.endY,n=!0),this._tile.scaleX=this.currX,this._tile.scaleY=this.currY,n&&this.props.onFinish()},t}(),g=4,O="#f5f5f5",T="#e0e0e0",w={COLOR_2:"#eee4da",COLOR_4:"#ede0c8",COLOR_8:"#f2b179",COLOR_16:"#f59563",COLOR_32:"#f67c5f",COLOR_64:"#f65e3b",COLOR_128:"#edcf72",COLOR_256:"#edcc61",COLOR_512:"#edc850",COLOR_1024:"#edc53f",COLOR_2048:"#edc22e",COLOR_DEFAULT:"#6dbb8c"},X=function(){function t(t,e,n){void 0===n&&(n=!1),this.hasBeenMerged=!1,this.move=null,this.scale=null,this.scaleX=1,this.scaleY=1,this.value=e,this.color=this.getColor(e),this.hasBeenMerged=n,this.setSlot(t)}return Object.defineProperty(t.prototype,"inMove",{get:function(){return null!==this.move},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slotX",{get:function(){return this._slot.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slotY",{get:function(){return this._slot.y},enumerable:!1,configurable:!0}),t.prototype.getColor=function(t){switch(t){case 2:return w.COLOR_2;case 4:return w.COLOR_4;case 8:return w.COLOR_8;case 16:return w.COLOR_16;case 32:return w.COLOR_32;case 64:return w.COLOR_64;case 128:return w.COLOR_128;case 256:return w.COLOR_256;case 512:return w.COLOR_512;case 1024:return w.COLOR_1024;case 2048:return w.COLOR_2048;default:return w.COLOR_DEFAULT}},Object.defineProperty(t.prototype,"valueOrder",{get:function(){return Math.log(this.value)/Math.log(2)},enumerable:!1,configurable:!0}),t.prototype.scaleAnimation=function(t,e){var n=this;this.scaleX=t,this.scaleY=t,this.scale=new b(this,{startX:t,startY:t,endX:1,endY:1,duration:e,onFinish:function(){n.scaleX=1,n.scaleY=1,n.scale=null}})},t.prototype.mergeAnimation=function(){var t=this;this.scaleX=1,this.scaleY=1,this.scale=new b(this,{startX:1,startY:1,endX:1.08+.02*this.valueOrder,endY:1.08+.02*this.valueOrder,duration:.5+.05*this.valueOrder,onFinish:function(){t.scale=new b(t,{startX:t.scale.currX,startY:t.scale.currY,endX:1,endY:1,duration:.5+.05*t.valueOrder,onFinish:function(){t.scale=null}})}})},Object.defineProperty(t.prototype,"X",{get:function(){return null!==this.move?this.move.currX:this.slotX},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Y",{get:function(){return null!==this.move?this.move.currY:this.slotY},enumerable:!1,configurable:!0}),t.prototype.act=function(){null!==this.move&&this.move.act(),null!==this.scale&&this.scale.act()},t.prototype.draw=function(){L.translate(this.X+this._slot.width/2,this.Y+this._slot.height/2),L.scale(this.scaleX,this.scaleY),L.fillStyle=this.getColor(this.value),L.fillRect(-this._slot.width/2+2,-this._slot.height/2+2,this._slot.width-4,this._slot.height-4),L.fillStyle=this.value<5?"#000000":"#FFFFFF";var t=8+Math.abs(this._slot.width/(.3*(""+this.value).length+3));L.font="".concat(t,"px Arial"),L.textAlign="center",L.textBaseline="middle",L.fillText(""+this.value,0,0),L.scale(1,1),L.setTransform(1,0,0,1,0,0)},Object.defineProperty(t.prototype,"row",{get:function(){return this._slot.row},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"col",{get:function(){return this._slot.col},enumerable:!1,configurable:!0}),t.prototype.canOccupy=function(t){return t.isEmpty()||t.hasOneTile()&&(t.uniqueTile.inMove||t.uniqueTile.value===this.value&&!t.uniqueTile.hasBeenMerged&&!this.hasBeenMerged)},t.prototype.moveOneStepTo=function(t,e){var n=this;this.move=new y(this,{startX:this.slotX,startY:this.slotY,endX:t.x,endY:t.y,onFinish:function(){n.onTileStepped(t,e)}})},t.prototype.onTileStepped=function(t,e){this.move=null,this.changeSlot(t),this._slot._table.oneTileMovedOneStep(e)},t.prototype.changeSlot=function(t){this._slot.deleteTile(this),t.addTile(this),this.setSlot(t)},t.prototype.setSlot=function(t){this._slot=t},t}(),Y=function(){function e(t,e,n){this.tiles=[],this.row=e,this.col=n,this._table=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._table.X+this.width*this.col},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._table.Y+this.height*this.row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._table.slotWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._table.slotHeight},enumerable:!1,configurable:!0}),e.prototype.existsNearSlot=function(e){var n=!0;switch(e){case t.Up:n=this.row>0;break;case t.Down:n=this.row<this._table.dimension-1;break;case t.Left:n=this.col>0;break;case t.Right:n=this.col<this._table.dimension-1}return n},e.prototype.isEmpty=function(){return 0===this.tiles.length},e.prototype.hasOneTile=function(){return 1===this.tiles.length},e.prototype.nearSlot=function(e){switch(e){case t.Up:return this._table.slots[this.row-1][this.col];case t.Down:return this._table.slots[this.row+1][this.col];case t.Left:return this._table.slots[this.row][this.col-1];case t.Right:return this._table.slots[this.row][this.col+1]}},Object.defineProperty(e.prototype,"uniqueTile",{get:function(){return this.tiles[0]},enumerable:!1,configurable:!0}),e.prototype.moveUniqueTileTo=function(t){var e=!1;if(this.hasOneTile()&&this.existsNearSlot(t)){var n=this.nearSlot(t);this.uniqueTile.canOccupy(n)&&(this.uniqueTile.moveOneStepTo(n,t),e=!0)}return e},e.prototype.addTile=function(t){this.tiles.push(t)},e.prototype.deleteTile=function(t){this.tiles.splice(this.tiles.indexOf(t),1)},e.prototype.hasTwoEqualTiles=function(){return 2===this.tiles.length&&this.tiles[0].value===this.tiles[1].value},e.prototype.mergeTiles=function(){var t=this.tiles[0].value;this.deleteTile(this.tiles[1]),this.deleteTile(this.tiles[0]);var e=new X(this,2*t,!0);e.mergeAnimation(),this.addTile(e)},e}(),_=function(){function e(){this.X=0,this.Y=0,this.tableInMove=!1,this.dimension=g,this.slots=[];for(var t=0;t<this.dimension;t++){this.slots[t]=[];for(var e=0;e<this.dimension;e++)this.slots[t][e]=new Y(this,t,e)}}return Object.defineProperty(e.prototype,"totalTiles",{get:function(){for(var t=[],e=0;e<this.dimension;e++)for(var n=0;n<this.dimension;n++)this.slots[e][n].isEmpty()||t.push.apply(t,this.slots[e][n].tiles);return t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"slotWidth",{get:function(){return R.width/this.dimension},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"slotHeight",{get:function(){return R.height/this.dimension},enumerable:!1,configurable:!0}),e.prototype.createFirstTiles=function(){this.createRandomTile(),this.createRandomTile()},e.prototype.createRandomTile=function(t){for(var e=[],n=0;n<this.dimension;n++)for(var i=0;i<this.dimension;i++)this.slots[n][i].isEmpty()&&e.push(this.slots[n][i]);var r=t||(Math.random()<.9?2:4),o=Math.floor(Math.random()*e.length),s=new X(e[o],r);s.scaleAnimation(0,3),e[o].addTile(s)},e.prototype.act=function(){this.totalTiles.forEach((function(t){return t.act()}))},e.prototype.draw=function(){this.drawTable(),this.totalTiles.forEach((function(t){return t.draw()}))},e.prototype.drawTable=function(){L.fillStyle=O,L.fillRect(this.X,this.Y,this.slotWidth*this.dimension,this.slotHeight*this.dimension),L.fillStyle=T;for(var t=0;t<=this.dimension;t++)L.fillRect(this.X+this.slotWidth*t-2,-2,4,this.slotHeight*this.dimension);for(var e=0;e<=this.dimension;e++)L.fillRect(-2,this.Y+this.slotHeight*e-2,this.slotWidth*this.dimension,4)},e.prototype.tryMoveOneStepTo=function(e){var n=!1;switch(e){case t.Up:for(var i=0;i<this.dimension;i++)for(var r=0;r<this.dimension;r++)this.slots[r][i].moveUniqueTileTo(e)&&(n=!0);break;case t.Down:for(i=0;i<this.dimension;i++)for(r=this.dimension-1;r>=0;r--)this.slots[r][i].moveUniqueTileTo(e)&&(n=!0);break;case t.Left:for(r=0;r<this.dimension;r++)for(i=0;i<this.dimension;i++)this.slots[r][i].moveUniqueTileTo(e)&&(n=!0);break;case t.Right:for(r=0;r<this.dimension;r++)for(i=this.dimension-1;i>=0;i--)this.slots[r][i].moveUniqueTileTo(e)&&(n=!0)}return n},e.prototype.oneTileMovedOneStep=function(t){this.totalTiles.find((function(t){return t.inMove}))||this.allTilesMovedOneStep(t)},e.prototype.allTilesMovedOneStep=function(t){this.doMergers(),this.tryMoveOneStepTo(t)||this.prepareNextTurn()},e.prototype.doMergers=function(){for(var t=0;t<this.dimension;t++)for(var e=0;e<this.dimension;e++)this.slots[t][e].hasTwoEqualTiles()&&this.slots[t][e].mergeTiles()},e.prototype.prepareNextTurn=function(){this.totalTiles.forEach((function(t){return t.hasBeenMerged=!1})),this.createRandomTile(),this.tableInMove=!1},e}(),x=function(){function t(){this.started=!1}return t.prototype.start=function(){this.table=new _,this.table.createFirstTiles(),this.started=!0},t.prototype.render=function(){this.clearScreen(),this.table.act(),this.table.draw()},t.prototype.clearScreen=function(){L.clearRect(0,0,R.width,R.height)},t.prototype.checkOrderTo=function(t){this.table.tableInMove||this.table.tryMoveOneStepTo(t)&&(this.table.tableInMove=!0)},t}(),R=document.getElementById("gameCanvas"),L=R.getContext("2d"),C=document.getElementById("canvasContainer");function M(){R&&(R.width=C.offsetWidth,R.height=1*R.width)}M(),window.addEventListener("resize",(function(){return M()}));var S=new x;S.start(),document.addEventListener("keydown",(function(e){e.preventDefault();var n=e.key;"ArrowLeft"===n?S.checkOrderTo(t.Left):"ArrowUp"===n?S.checkOrderTo(t.Up):"ArrowRight"===n?S.checkOrderTo(t.Right):"ArrowDown"===n&&S.checkOrderTo(t.Down)}));var E=null,j=null;document.addEventListener("touchstart",(function(t){t.preventDefault(),console.log("start",t),E=t.touches[0].clientX,j=t.touches[0].clientY})),document.addEventListener("touchmove",(function(e){e.preventDefault();var n=e.touches[0].clientX,i=e.touches[0].clientY;j&&i-j>=12?(E=n,j=i,S.checkOrderTo(t.Down)):j&&i-j<=-12&&(E=n,j=i,S.checkOrderTo(t.Up)),E&&n-E>=12?(E=n,j=i,S.checkOrderTo(t.Right)):E&&n-E<=-12&&(E=n,j=i,S.checkOrderTo(t.Left))})),document.querySelector(".restart").addEventListener("click",(function(t){t.preventDefault(),S.start()})),function t(){S&&S.started&&S.render(),requestAnimationFrame(t)}()})()})();